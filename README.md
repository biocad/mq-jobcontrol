# mq-jobcontrol
Component for interactions with Monique via interface.

## Назначение

Компонент jobcontrol предоставляет пользователю возможность отправлять в Monique порождающие ответ сообщения
и проверять, что система будет их корректно обрабатывать.

Взаимодействие пользователя с компонентом происходт посредством терминала.

## Конфигурация

Jobcontrol является компонентом Monique, общающимся с самой очередью исключительно через scheduler'а.
В силу этого никакой информации про контроллер в config.json указывать не надо. 

Все остальные поля являются стандартными для любого компонента системы.

## Запуск

Запуск компонента производится командой:

```
./mq-jobcontrol
```

## Использование

После запуска компонента в терминале откроется окно ввода, с помощью которого можно посылать сообщения в Monique.

Пользователю доступны три команды:

* **run** позволяет отправить сообщение в очередь;
* **help run** позволяет посмотреть, какие аргументы принимает на вход команда **run**;
* **help** выводит список всех доступных команд с их описанием.

### run

Команда **run** принимает четыре аргумента в следующем порядке:

* **spec** отправляемого сообщения;
* тип отправляемого сообщения: config, response, data или error;
* тип кодировки содержимого поля **data** отправляемого сообщения: JSON или MessagePack;
* путь до файла, содержащего в формате *byte string* информацию, которая будет отправлена в поле **data**;
данный *byte string* должен быть получен конвертацией либо из JSON'а, либо из MessagePack'а.

## Логика работы

После того, как пользователь запустил команду **run**, из переданных в неё аргументов формируется сообщение и отправляется в очередь.

Компонент jobcontrol подписывается на любые сообщения из очереди, в поле **pid** которых будет стоять **id**, сгенерироанный для отправленного сообщения.

Первое полученное таким образом сообщение будет выведено в консоль.